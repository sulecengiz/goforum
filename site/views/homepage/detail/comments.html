{{ define "renderComment" }}
{{ range . }}

<style>
    .comment-content{ word-break: break-word; }
    .comment-mention { font-weight: bold; color: #007bff; margin-right: 5px; }
    .like-btn.liked .like-icon { color: #e0245e; }
    .like-count { font-size: 0.85rem; margin-left: 4px; color:#555; }
    .like-label { font-size:0.75rem; margin-left:6px; color:#666; }
    .like-btn { border:none; background:transparent; cursor:pointer; display:inline-flex; align-items:center; }
    .like-btn:disabled { opacity:.6; cursor:progress; }
</style>
<div class="comment-with-avatar" id="comment-{{ .ID }}">
    <div class="comment-avatar">
        {{ substr .Name 0 1 | upper }}
    </div>
    <div class="comment-body">
        <div class="comment-header">
            <span class="comment-author">{{ .Name }}</span>
        </div>
        <div class="comment-content">
            {{ if .ParentName }}<span class="comment-mention">@{{ .ParentName }}</span>{{ end }}
            {{ .Comment }}
        </div>
        <div class="comment-actions">
            <button class="comment-action-btn like-btn me-2 {{ if .IsLiked }}liked{{ end }}" data-comment-id="{{ .ID }}" aria-label="Beğen / Beğenme Kaldır">
                <i class="{{ if .IsLiked }}fas{{ else }}far{{ end }} fa-heart like-icon" id="like-icon-{{ .ID }}"></i>
                <span class="like-count" id="like-count-{{ .ID }}">{{ .LikeCount }}</span>
                <span class="like-label" id="like-label-{{ .ID }}">
                    {{ if gt .LikeCount 0 }}
                        {{ if eq .LikeCount 1 }} beğeni{{ else }} beğeni{{ end }}
                    {{ else }}Beğen{{ end }}
                </span>
            </button>
            <button class="comment-action-btn reply-btn" data-comment-id="{{ .ID }}" data-reply-to="{{ .Name }}"><i class="fas fa-reply"></i></button>
            <span class="comment-date">{{ .CreatedAt.Format "02.01.2006 15:04" }}</span>
            {{ if .Replies }} 
            <button class="toggle-replies-btn" data-target="replies-{{ .ID }}">{{ len .Replies }} replies</button>
            {{ end }}
        </div>

        {{ if .Replies }}
        <div id="replies-{{ .ID }}" class="replies-container" style="display: none;">
            <div class="reply-comment">
                {{ template "renderComment" .Replies }}
            </div>
        </div>
        {{ end }}
    </div>
</div>
{{ end }}
{{ end }}